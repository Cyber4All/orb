description: >
  This command checks in the semantic version for a repository has been published already in docker.
  This command is used a validation step prior to publishing the new docker image version.

parameters:
  # Required Parameters
  tag:
    type: string
    description: |
      The semantic version of the project trying to be deployed
      https://semver.org/spec/v2.0.0.html
  image:
    type: string
    description: |
      The name of the repository on dockerhub
  # Not Required Parameters
  organization:
    type: string
    default: "cyber4all"
    description: |
      The name of the docker organization

steps:
  - run:
      name: "Check that semantic version is unique on Dockerhub"
      command: <<include(scripts/check-docker-semver.sh)>>
      environment:
        DOCKER_SEMVER: <<parameters.tag>>
        DOCKER_ORGANIZATION: <<parameters.organization>>
        DOCKER_REPOSITORY: <<parameters.image>>
