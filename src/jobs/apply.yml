description: |
  Applies terraform plan and outputs to the stdout.

parameters:
  role-arn:
    type: env_var_name
    default: CIRCLECI_OIDC_ROLE
    description: The Amazon Resource Name (ARN) of the role that the caller is assuming. Role ARN must be configured for web identity.

executor:
  name: tf/default
  tag: 1.2.9

steps:
  - aws-cli/setup:
      role-arn: "$<<parameters.role-arn>>"
  - attach_workspace:
      at: .
  - tf/apply:
      plan: tfplan
